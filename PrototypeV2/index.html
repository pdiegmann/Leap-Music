<html>
<head>
	<link href="css/style.css" rel="stylesheet" />

	<script src="js/jquery.min.js"></script>
	<script src="js/jquery-migrate.min.js"></script>
	<script src="js/three.min.js"></script>
	<script src="js/leap.min.js"></script>
	<script src="js/timbre.min.js"></script>
	<script src="js/rainbowvis.js"></script>
	<!--<script src="js/underscore.js"></script>-->

	<script src="js/visual.js"></script>
	<script src="js/audible.js"></script>
	<script src="js/intercom.js"></script>
	<script src="js/input.js"></script>
	<script src="js/views.js"></script>
	<script src="js/gamestate.js"></script>
	<script src="js/Music.js"></script>
</head>
<body>
	<div id="content">
		<div id="output">
			
		</div>
		<div id="mainView" class="fullScreenView hidden">
			<h1><a id="mainView_startFreeGame">Freies Spiel starten...</a></h1>
			<hr/>
			<h1>Song-Datei w√§hlen: <input type="file" id="songFile" name="songFile" /></h1>
			<h1><a class="hidden" id="mainView_startScoreGame">Spiel starten...</a></h1>
		</div>
		<div id="gameView" class="fullScreenView hidden"></div>
	</div>

	<script>
	 	var output = document.getElementById('output');
	 	window.onload = function() {
		// Check for the various File API support.
		if (window.File && window.FileReader && window.FileList && window.Blob) {
			// Great success! All the File APIs are supported.
			document.getElementById('songFile').addEventListener('change', handleFileSelect, false);
			function handleFileSelect(evt) {
			    var files = evt.target.files; // FileList object

			    // Loop through the FileList and render image files as thumbnails.
			    for (var i = 0, f; f = files[i]; i++) {
			    	var reader = new FileReader();

				    // Closure to capture the file information.
				    reader.onload = (function(theFile) {
				    	return function(e) {
				    		Music.initSong(JSON.parse(e.target.result));
				    		$('#mainView_startScoreGame').show();
				    	}
				    })(f);

				    // Read in the image file as a data URL.
      				reader.readAsText(f);
			    }
			}
		} else {
			alert('The File APIs are not fully supported in this browser.');
			$('#songFile').hide();
		}
	 		InterCom.init();
	 	};
	</script>
</body>